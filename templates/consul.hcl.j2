datacenter = "{{consul_datacenter}}"
data_dir = "{{consul_data_dir}}"
encrypt = "{{consul_encrypt_key}}"
log_level = "INFO"
server = true
bootstrap_expect = {{ groups['consul_servers'] | length }}
ui = true
node_name = "{{ ansible_hostname }}"
advertise_addr = "{{ inventory_hostname }}"
client_addr = "{{ inventory_hostname }}"

ports {
  https = 8501
}

key_file = "/etc/consul.d/tls/{{ consul_datacenter }}-server-consul-0-key.pem"
cert_file = "/etc/consul.d/tls/{{ consul_datacenter }}-server-consul-0.pem"
ca_file = "/etc/consul.d/tls/consul-agent-ca.pem"

{% if consul_use_acl %}
acl = {
  enabled = true
  default_policy = "deny"
  enable_token_persistence = true
}
{% endif %}